angular.module("googleTranslateModule",[]).factory("Translate",function(n){var e={English:"en",Chinese:"zh-CN",Spanish:"es",French:"fr",Italian:"it"},o=function(o,t){return n({method:"GET",url:"https://www.googleapis.com/language/translate/v2",params:{key:"AIzaSyBC5v0BqpuJz6g3roho0JUkwzAX0PoR2Dk",target:e[t],q:o}}).then(function(n){return n.data})};return{translateMsg:o}}),angular.module("languageApp",["googleTranslateModule","ngFx"]).controller("selectLanguageController",function(n,e,o){n.languages=[["English","us"],["Chinese","cn"],["Spanish","es"],["French","fr"],["Italian","it"]],n.language={},n.showChatApp=!1,n.msg="",n.convo="",n.state={stage:"a"},n.submitLanguages=function(t){return e({method:"GET",url:"/api/getroom",params:t}).success(function(e){n.comm=new Icecomm("IbQqKDNCGQS7b94Mllk/iHOJbeSe/UrJJy6l1BbqEbP0fKaK"),n.comm.connect(e),n.comm.on("local",function(n){localVideo.src=n.stream}),n.comm.on("connected",function(e){document.getElementById("videos").insertBefore(e.video,document.getElementById("myVideo")),n.$apply(function(){n.showChatApp=!0})}),n.comm.on("data",function(e){n.$apply(function(){o.translateMsg(e.data,n.language["native"],n.language.desired).then(function(o){console.log(o);var t=o.data.translations[0].translatedText;n.convo+="You: "+e.data+"\n",n.convo+="You (translated): "+t+"\n",n.scrollBottom()})})}),n.comm.on("disconnect",function(e){document.getElementById(e.callerID).remove(),n.$apply(function(){n.showChatApp=!1})})})},n.sendMsg=function(){""!==n.msg.trim()&&(n.comm.send(n.msg),n.convo+="Me: "+n.msg+"\n",n.msg="",n.scrollBottom(),document.getElementById("chatMsg").focus())},n.handleKeyPress=function(e){13===e.which&&n.sendMsg()},n.scrollBottom=function(){var n=document.getElementById("chatBox");n.scrollTop=n.scrollHeight}});